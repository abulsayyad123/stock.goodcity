<nav class="tab-bar new-user-nav">
 <section class="left-small" >
   {{#link-to "users.details" user.id class="user-back-link"}}
    <i class="back_icon" aria-hidden="true">{{fa-icon 'angle-left'}}</i>
    <div>{{t 'back'}}</div>
  {{/link-to}}
  </section>
  <section class="middle tab-bar-section">
    <h1 class="title">{{t 'organisation.contact_details'}}</h1>
  </section>
</nav>

<section class="main-section add-user-form new-user-section user-details-section ui ">

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'users.image'}}
    </div>
    <div class="small-7 columns">
      <div>
        <span class={{if user.image "image" "image-box"}}>
           {{log user.image}}
          {{#if user.image}}
            {{image-zoom item=user}}
          {{else}}
            <i aria-hidden="true">{{fa-icon 'camera'}}</i><br />
            {{t 'users.add_image'}}
          {{/if}}
        </span>
       </div>
     <div class="item-label image-edit">
        <a {{action "triggerUpload"}}  class="{{unless isReady 'disabled'}}">
      Edit

        {{!-- <span class="image-box">
          {{#if newUploadedImage}}
          <img src={{newUploadedImage.thumbImageUrl}} class="thumb" />
          {{else}}
          <i aria-hidden="true">{{fa-icon 'camera'}}</i><br />
          {{t 'users.add_image'}}
          {{/if}}
        </span> --}}
      </a>
      {{cloudinary-upload ready="uploadReady" progress="uploadProgress"
       always="uploadComplete" done="uploadEditedImageSuccess" submit="uploadStart"}}
       {{!-- {{action "hha"}} --}}
    </div>
    </div>

  </div>

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'order.title'}}
    </div>
    <div class="small-7 columns field-container title-select">
      {{inline-select-list
        content=titles
        name="title"
        item=user
        isPrimitive=true
        autosave=true
        on-change=(action (mut selectedTitle))
      }}
    </div>
  </div>

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'organisation.user.first_name'}}
    </div>
    <div class="small-7 columns field-container">
      {{!-- {{#form-control}} --}}
      {{input type='text'
        id="firstName"
        value=user.firstName
        focusOut=(action "focusOut" "firstName" user.firstName true)
        focusIn=(action "focusIn" "firstName" user.firstName)
      }}
      {{log firstNameInputError}}
      {{#if firstNameInputError}}
       <div class='inline-edit-error'>{{t 'organisation.user.validation_error.first_name'}}</div>
       {{/if}}
      {{!-- {{/form-control}} --}}
    </div>
  </div>

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'organisation.user.last_name'}}
    </div>
    <div class="small-7 columns field-container ">
      {{input type='text'
        id="lastName"
        value=user.lastName
        focusOut=(action "focusOut" "lastName" user.lastName true)
        focusIn=(action "focusIn" "lastName" user.lastName)
      }}
      {{#if lastNameInputError}}
        <div class='inline-edit-error'>{{t 'organisation.user.validation_error.family_name'}}</div>
      {{/if}}
    </div>
  </div>

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'organisation.user.email'}}
    </div>
    <div class="small-7 columns field-container">
      {{input type="email"
        value=user.email
        name="email"
        id="email"
        formnovalidate="true"
        focusOut=(action "focusOut" "email" user.email mobileNotPresent)
        focusIn=(action "focusIn" "email" user.email)
      }}

      {{#if emailInputError}}
        <div class='inline-edit-error'>{{t 'organisation.user.validation_error.blank_email'}}</div>
      {{/if}}

      {{#if emailValidationError}}
        <div class='inline-edit-error'>{{t 'organisation.user.validation_error.email'}}</div>
      {{/if}}
    </div>
  </div>

  <div class="row mobile">
    <div class="small-5 columns item-label">
      {{t 'organisation.user.mobile'}}
    </div>
    <div class="small-1 columns ui dialing-code">
      <label>{{t "mobile_prefix"}}</label>
    </div>
    <div class="small-6 columns ss field-container">
      {{numeric-input
        value=user.mobileWithoutCountryCode
        formnovalidate="true"
        name="mobilePhone"
        id="mobile"
        maxlength="8"
        focusIn=(action "focusIn" "mobile" user.mobileWithoutCountryCode)
        focusOut=(action "focusOut" "mobile" user.mobileWithoutCountryCode emailIdNotPresent)
        pattern=".{8,}"}}

      {{#if mobileInputError}}
        <div class='inline-edit-error'>{{t 'organisation.user.validation_error.blank_mobile_number'}}</div>
      {{/if}}

      {{#if mobileValidationError}}
        <div class='inline-edit-error'>{{t 'organisation.user.validation_error.mobile'}}</div>
      {{/if}}
    </div>
  </div>

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'organisation.user.district'}}
    </div>
    <div class="small-7 columns field-container">
      {{select-list
        content=districts
        prompt="--"
        on-change=(action "changeDistrict")
        selectedValue=user.associatedDistrict
        selectArrow=true
      }}
    </div>
  </div>

  <div class="row">
    <div class="small-5 columns item-label">
      {{t 'organisation.user.preferred_language'}}
    </div>
    <div class="small-7 columns field-container ">
      {{inline-select-list
        content=languages
        prompt="Unknown"
        name="preferredLanguage"
        item=user
        isPrimitive=true
        autosave=true
        on-change=(action (mut selectedLanguage))
      }}
    </div>
  </div>
</section>
{{partial "loading_image"}}
